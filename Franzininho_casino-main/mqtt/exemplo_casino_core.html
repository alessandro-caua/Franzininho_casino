<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <title>üé∞ Exemplo - Casino Core Library</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&display=swap" rel="stylesheet">
  
  <!-- MQTT Library -->
  <script src="https://unpkg.com/mqtt/dist/mqtt.min.js"></script>
  
  <!-- Casino Core Library -->
  <script src="casino-core.js"></script>
  
  <style>
    body {
      background: #0a0a0f;
      color: #e0e0e0;
      font-family: 'Orbitron', monospace;
      padding: 40px 20px;
      min-height: 100vh;
    }
    .container {
      max-width: 800px;
      margin: 0 auto;
    }
    h1 {
      color: #00ffff;
      text-align: center;
      margin-bottom: 30px;
      text-shadow: 0 0 20px rgba(0, 255, 255, 0.8);
    }
    .demo-section {
      background: rgba(15, 15, 25, 0.95);
      border: 2px solid rgba(0, 255, 255, 0.3);
      border-radius: 15px;
      padding: 25px;
      margin: 20px 0;
    }
    .demo-title {
      color: #00ffff;
      font-size: 1.3em;
      margin-bottom: 15px;
      border-bottom: 2px solid #00ffff;
      padding-bottom: 10px;
    }
    .btn {
      padding: 12px 24px;
      border: 2px solid #00ffff;
      border-radius: 8px;
      background: rgba(0, 255, 255, 0.1);
      color: #00ffff;
      cursor: pointer;
      font-family: 'Orbitron', monospace;
      font-weight: 700;
      text-transform: uppercase;
      margin: 5px;
      transition: all 0.3s ease;
    }
    .btn:hover {
      background: rgba(0, 255, 255, 0.3);
      box-shadow: 0 0 20px rgba(0, 255, 255, 0.5);
    }
    .status {
      padding: 15px;
      margin: 15px 0;
      border-radius: 8px;
      background: rgba(0, 0, 0, 0.5);
      border: 2px solid #00ffff;
    }
    code {
      background: rgba(0, 0, 0, 0.7);
      padding: 2px 6px;
      border-radius: 3px;
      color: #00ff41;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>üé∞ CASINO CORE LIBRARY - DEMO</h1>
    
    <!-- MQTT Connection -->
    <div class="demo-section">
      <div class="demo-title">1. CONEX√ÉO MQTT</div>
      <p>Clique para conectar ao broker MQTT:</p>
      <button class="btn" onclick="connectMQTT()">üîå CONECTAR</button>
      <button class="btn" onclick="disconnectMQTT()">üîå DESCONECTAR</button>
      <div class="status" id="mqttStatus">
        <strong>Status:</strong> Aguardando conex√£o...
      </div>
    </div>

    <!-- Toast Notifications -->
    <div class="demo-section">
      <div class="demo-title">2. NOTIFICA√á√ïES TOAST</div>
      <p>Teste os diferentes tipos de notifica√ß√µes:</p>
      <button class="btn" style="border-color: #00ff41; color: #00ff41;" onclick="toast.success('Opera√ß√£o realizada com sucesso!')">
        ‚úÖ SUCESSO
      </button>
      <button class="btn" style="border-color: #ff0055; color: #ff0055;" onclick="toast.error('Erro ao processar solicita√ß√£o!')">
        ‚ùå ERRO
      </button>
      <button class="btn" style="border-color: #ffaa00; color: #ffaa00;" onclick="toast.warning('Aten√ß√£o! Cr√©ditos baixos.')">
        ‚ö†Ô∏è AVISO
      </button>
      <button class="btn" onclick="toast.info('Informa√ß√£o importante aqui.')">
        ‚ÑπÔ∏è INFO
      </button>
    </div>

    <!-- MQTT Publish -->
    <div class="demo-section">
      <div class="demo-title">3. PUBLICAR COMANDOS</div>
      <p>Teste enviar comandos para o ESP32:</p>
      <button class="btn" onclick="sendLED('255,0,0')">üî¥ LED VERMELHO</button>
      <button class="btn" onclick="sendLED('0,255,0')">üü¢ LED VERDE</button>
      <button class="btn" onclick="sendLED('0,0,255')">üîµ LED AZUL</button>
      <button class="btn" onclick="sendBuzzer(1000)">üîä BUZZER 1000Hz</button>
    </div>

    <!-- Helper Functions -->
    <div class="demo-section">
      <div class="demo-title">4. FUN√á√ïES AUXILIARES</div>
      <p>Teste as fun√ß√µes utilit√°rias:</p>
      <button class="btn" onclick="testHexToRgb()">üé® Hex ‚Üí RGB</button>
      <button class="btn" onclick="testFormatNumber()">üî¢ Formatar N√∫mero</button>
      <button class="btn" onclick="testPlaySound()">üîä Tocar Som</button>
      <div class="status" id="utilsResult">
        <strong>Resultado:</strong> Aguardando teste...
      </div>
    </div>

    <!-- Code Example -->
    <div class="demo-section">
      <div class="demo-title">5. EXEMPLO DE C√ìDIGO</div>
      <pre style="background: #000; padding: 15px; border-radius: 8px; overflow-x: auto; color: #00ff41; font-size: 0.9em;">
<code>// Inicializar MQTT
const mqtt = new CasinoMQTT({
  clientId: 'meu-jogo-123'
});

await mqtt.connect();

// Subscrever t√≥picos
mqtt.subscribe('IFCE_caua/credits', (msg) => {
  console.log('Cr√©ditos:', msg);
  toast.success(`Cr√©ditos atualizados: ${msg}`);
});

// Publicar comando
mqtt.publish('IFCE_caua/led_control', '255,0,0');

// Notifica√ß√µes
toast.success('Voc√™ ganhou!');
toast.error('Cr√©ditos insuficientes!');

// Utils
const rgb = casinoUtils.hexToRgb('#ff0055');
const formatted = casinoUtils.formatNumber(1000000);
casinoUtils.playSound(800, 150);</code></pre>
    </div>
  </div>

  <script>
    let casinoMQTT = null;

    async function connectMQTT() {
      try {
        if (casinoMQTT && casinoMQTT.isConnected) {
          toast.warning('J√° est√° conectado!');
          return;
        }

        casinoMQTT = new CasinoMQTT({
          clientId: 'demo-' + Math.random().toString(16).slice(2, 8)
        });

        await casinoMQTT.connect();
        
        // Subscreve alguns t√≥picos para demonstra√ß√£o
        casinoMQTT.subscribe('IFCE_caua/credits', (msg) => {
          document.getElementById('mqttStatus').innerHTML = 
            `<strong>Status:</strong> Conectado ‚úÖ<br>
             <strong>√öltimo cr√©dito recebido:</strong> ${msg}`;
        });

        casinoMQTT.subscribe('IFCE_caua/botoes/#', (msg, topic) => {
          const button = topic.split('/').pop();
          toast.info(`Bot√£o ${button} pressionado!`);
        });

        document.getElementById('mqttStatus').innerHTML = 
          '<strong>Status:</strong> Conectado ‚úÖ<br>Aguardando mensagens...';

      } catch (error) {
        toast.error('Erro ao conectar: ' + error.message);
        document.getElementById('mqttStatus').innerHTML = 
          '<strong>Status:</strong> Erro de conex√£o ‚ùå';
      }
    }

    function disconnectMQTT() {
      if (casinoMQTT) {
        casinoMQTT.disconnect();
        casinoMQTT = null;
        document.getElementById('mqttStatus').innerHTML = 
          '<strong>Status:</strong> Desconectado';
        toast.info('Desconectado do servidor');
      } else {
        toast.warning('N√£o est√° conectado!');
      }
    }

    function sendLED(rgb) {
      if (!casinoMQTT || !casinoMQTT.isConnected) {
        toast.error('Conecte ao MQTT primeiro!');
        return;
      }

      casinoMQTT.publish('IFCE_caua/led_control', rgb);
      toast.success(`LED configurado: RGB(${rgb})`);
    }

    function sendBuzzer(freq) {
      if (!casinoMQTT || !casinoMQTT.isConnected) {
        toast.error('Conecte ao MQTT primeiro!');
        return;
      }

      casinoMQTT.publish('IFCE_caua/buzzer_control', String(freq));
      toast.success(`Buzzer tocando em ${freq}Hz`);
      
      // Toca tamb√©m no navegador
      casinoUtils.playSound(freq, 300);
    }

    function testHexToRgb() {
      const hex = '#ff0055';
      const rgb = casinoUtils.hexToRgb(hex);
      document.getElementById('utilsResult').innerHTML = 
        `<strong>Resultado:</strong> ${hex} ‚Üí RGB(${rgb})`;
      toast.info(`Convertido: ${hex} ‚Üí RGB(${rgb})`);
    }

    function testFormatNumber() {
      const num = 1234567;
      const formatted = casinoUtils.formatNumber(num);
      document.getElementById('utilsResult').innerHTML = 
        `<strong>Resultado:</strong> ${num} ‚Üí ${formatted}`;
      toast.info(`Formatado: ${num} ‚Üí ${formatted}`);
    }

    function testPlaySound() {
      // Toca uma sequ√™ncia de notas
      const notes = [262, 294, 330, 349, 392]; // C D E F G
      notes.forEach((freq, i) => {
        setTimeout(() => {
          casinoUtils.playSound(freq, 200);
        }, i * 250);
      });
      document.getElementById('utilsResult').innerHTML = 
        '<strong>Resultado:</strong> Tocando melodia (C D E F G)';
      toast.info('Tocando melodia de teste!');
    }
  </script>
</body>
</html>
